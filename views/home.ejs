<html>

<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/css/bootstrap.min.css" integrity="sha384-AysaV+vQoT3kOAXZkl02PThvDr8HYKPZhNT5h/CXfBThSRXQ6jW5DO2ekP5ViFdi" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/js/bootstrap.min.js" integrity="sha384-BLiI7JTZm+JWlgKa0M0kGRpJbF2J8q+qreVrKBC47e3K6BW78kGLrCkeRX6I9RoK" crossorigin="anonymous"></script>

<script type="text/javascript">

    function addEventToPage(ev) {
        var tbody = $("#tbody")
        console.log(ev.summary)

        var container = $('<tr></tr>')

        // summary
        container.append("<td>" + ev.summary + "</td>")

        // start/end
        if (ev.start.date != null) {
            container.append("<td>" + Date(ev.start.date) + "</td")
            container.append("<td>" + Date(ev.end.date) + "</td")
        } else if (ev.start.dateTime != null) {
            container.append("<td>" + Date(ev.start.dateTime) + "</td")
            container.append("<td>" + Date(ev.end.dateTime) + "</td")
        } else {
            container.append("<td>" + "Unknown" + "</td")
            container.append("<td>" + "Unknown" + "</td")
        }

        // location
        if (ev.location != null) {
            container.append("<td>" + ev.location + "</td")
        } else {
            container.append("<td>" + "Unknown" + "</td")
        }

        // reminders
        if (ev.reminders.overrides != null) {
            container.append("<td>" + ev.reminders.overrides.length + "</td")
        } else {
            container.append("<td>" + "None" + "</td")
        }

        tbody.append(container)
    }

    $(function() {
        var events = <%- JSON.stringify(events) %>
        console.log(events)
        for (var i = 0; i < events.length; i++) {
            var ev = events[i]
            addEventToPage(ev)
        };
    })

</script>
</head>

<body>

    <nav class="navbar navbar-light bg-faded">
        <span class="navbar-text float-xs-right text-muted">
            <a class="btn btn-primary" href='/logout' role="button">Logout</a>
        </span>
    </nav>

    <table class="table table-hover">
        <thead>
            <tr>
                <th>Summary</th>
                <th>Start</th>
                <th>End</th>
                <th>Location</th>
                <th>Reminders?<th>
            </tr>
        </thead>
        <tbody id="tbody">
        </tbody>
    </table>

    <iframe src="https://calendar.google.com/calendar/embed?src=skmehta@andrew.cmu.edu&ctz=America/New_York" style="border: 0" width="800" height="600" frameborder="0" scrolling="no"></iframe>
</body>

</html>